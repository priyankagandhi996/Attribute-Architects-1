--Payroll Summary Procedure--
CREATE OR REPLACE PROCEDURE Calc_PayrollSummary(
    p_PayPeriod DATE
)
IS
p_EmployeeCount INT;
p_GrossPaySum Float;
p_DeductionsSum Float;
p_NetPaySum Float;

BEGIN
    SELECT COUNT(DISTINCT t.EmployeeID),
           SUM(ps.GrossPay),
           SUM(ps.Deductions),
           SUM(ps.NetPay)
    INTO p_EmployeeCount, p_GrossPaySum, p_DeductionsSum, p_NetPaySum
    FROM TIMESHEET t
    INNER JOIN PAYSTUB ps ON t.TimeSheetID = ps.TimeSheetID
    WHERE t.PayPeriod = p_PayPeriod;
    
    DBMS_OUTPUT.PUT_LINE('Number of Employees with Paystubs: ' || p_EmployeeCount);
    DBMS_OUTPUT.PUT_LINE('Total Gross Pay: ' || p_GrossPaySum);
    DBMS_OUTPUT.PUT_LINE('Total Deductions: ' || p_DeductionsSum);
    DBMS_OUTPUT.PUT_LINE('Total Net Pay: ' || p_NetPaySum);
    
END Calc_PayrollSummary;

--Testing Procedure--

set serveroutput on;
execute  Calc_PayrollSummary(DATE '2023-01-01');
